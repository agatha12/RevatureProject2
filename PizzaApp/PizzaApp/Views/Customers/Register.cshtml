@model PizzaEntities.Customer
@using Microsoft.AspNetCore.Http
@{
    ViewData["Title"] = "Register";
}

<h2>Register</h2>

<div class="row">
    <div class="col-md-4">

            <div class="form-group">
                <label class="control-label">First Name</label>
                <input class="form-control" id="firstName" name="firstName" type="text" />
            </div>
            <div class="form-group">
                <label class="control-label">Last Name</label>
                <input class="form-control" id="lastName" type="text" />
            </div>
            <div class="form-group">
                <label class="control-label">Address</label>
                <input type="text" id="address" class="form-control" />
            </div>
            <div class="form-group">
                <label class="control-label">Phone Number</label>
                <input id="phoneNumber" type="tel" class="form-control" />
                <span asp-validation-for="phoneNumber" class="text-danger"></span>
            </div>
            <div class="form-group">
                <label class="control-label">Credit Card Number</label>
                <input type="text" id="creditCardNumber" class="form-control" />
                <span asp-validation-for="creditCardNumber" class="text-danger"></span>
            </div>
            <div class="form-group">
                <label class="control-label">Expiration Date</label>
                <input type="text" id="expDate" class="form-control" />
                <span asp-validation-for="expDate" class="text-danger"></span>
            </div>
            <div class="form-group">
                <label class="control-label"> CVC</label>
                <input id="cvc" type="text" class="form-control" />
                <span asp-validation-for="cvc" class="text-danger"></span>
            </div>
            <div class="form-group">
                <label class="control-label">Email</label>
                <input id="email" type="text" class="form-control" />
                <span asp-validation-for="email" class="text-danger"></span>
            </div>
            <div class="form-group">
                <label class="control-label">Password</label>
                <input id="password" type="text" class="form-control" />
                <span asp-validation-for="password" class="text-danger"></span>
            </div>
            <div class="form-group">
                <input type="submit" value="Register" class="btn btn-default" id="register" />
            </div>
            
    </div>
</div>

<script>
    $('#register').click(function () {

        event.preventDefault();


        var url = "@ViewData["url"]"+"/api/customers/";
        var id = @ViewData["id"]

        $.ajax({
            contentType: 'application/json',
            type: "POST",
            url: url,
            data: JSON.stringify({
                id:id,
                firstName: $('#firstName').val(),
                lastName: $("#lastName").val(),
                address: $("#address").val(),
                phoneNumber: $("#phoneNumber").val(),
                creditCardNumber: $("#creditCardNumber").val(),
                expDate: $("#expDate").val(),
                cvc: $("#cvc").val(),
                email: $("#email").val(),
                password: $("#password").val()
            }),
            success: function (data, textStatus, jqXHR) {
                console.log(data)
                console.log(textStatus)
                console.log(jqXHR)

                var name = data.firstName + " " + data.lastName
                @*@HttpContext.Session.SetInt32("id", id);
                @HttpContext.Session.SetString("Name", name);*@

                var ls = window['localStorage'];

                ls.setItem("id", id);

                window.location.href = "https://localhost:44390/Home/Register/"+id;

            },
            error: function (jqXHR, textStatus, errorThrown) {
                console.log(jqXHR.statusText);
            }
        });



    });

</script>
